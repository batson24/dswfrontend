{"ast":null,"code":"var _jsxFileName = \"/Users/batson24/Desktop/Date_Site/frontend/src/Routes/Room.js\";\nimport React, { useRef, useEffect, callUser } from \"react\";\nimport io from \"socket.io-client\";\n\nconst Room = props => {\n  const userVideo = useRef();\n  const partnerVideo = useRef();\n  const peerRef = useRef();\n  const socketRef = useRef();\n  const otherUser = useRef();\n  const userStream = useRef();\n  useEffect(() => {\n    navigator.mediaDevices.getUserMedia({\n      audio: true,\n      video: true\n    }).then(stream => {\n      userVideo.current.srcObject = stream;\n      userStream.current = stream;\n      socketRef.current = io.connect(\"/\");\n      socketRef.current.emit(\"join room\", props.match.params.roomID);\n      socketRef.current.on('other user', userID => {\n        callUser(userID);\n        otherUser.current = userID;\n      });\n      socketRef.current.on(\"user joined\", userID => {\n        otherUser.current = userID;\n      });\n      socketRef.current.on(\"offer\", handleRecieveCall);\n      socketRef.current.on(\"answer\", handleAnswer);\n      socketRef.current.on(\"ice-candidate\", handleNewICECandidateMsg);\n    });\n  }, []);\n\n  function callUser(userID) {\n    peerRef.current = createPeer(userID);\n    userStream.current.getTracks().forEach(track => peerRef.current.addTrack(track, userStream.current));\n  }\n\n  function createPeer(userID) {\n    const peer = new RTCPeerConnection({\n      iceServers: [{\n        urls: \"stun:stun.stunprotocol.org\"\n      }, {\n        urls: 'turn:numb.viagenie.ca',\n        credential: 'batson',\n        username: 'webrtc@live.com'\n      }]\n    });\n    peer.onicecandidate = handleICECandidateEvent;\n    peer.ontrack = handleTrackEvent;\n\n    peer.onnegotiationneeded = () => handleNegotiationNeededEvent(userID);\n\n    return peer;\n  }\n\n  function handleNegotiationNeededEvent(userID) {\n    peerRef.current.createOffer().then(offer => {\n      return peerRef.current.setLocalDescription(offer);\n    }).then(() => {\n      const payload = {\n        target: userID,\n        caller: socketRef.current.id,\n        sdp: peerRef.current.localDescription\n      };\n      socketRef.current.emit(\"offer\", payload);\n    }).catch(e => console.log(e));\n  }\n\n  function handleRecieveCall(incoming) {\n    peerRef.current = createPeer();\n    const desc = new RTCSessionDescription(incoming.sdp);\n    peerRef.current.setRemoteDescription(desc).then(() => {\n      userStream.current.getTracks().forEach(track => peerRef.current.addTrack(track, userStream.current));\n    }).then(() => {\n      return peerRef.current.createAnswer();\n    }).then(answer => {\n      return peerRef.current.setLocalDescription(answer);\n    }).then(() => {\n      const payload = {\n        target: incoming.caller,\n        caller: socketRef.current.id,\n        sdp: peerRef.current.localDescription\n      };\n      socketRef.current.emit(\"answer\", payload);\n    });\n  }\n\n  function handleAnswer(message) {\n    const desc = new RTCSessionDescription(message.sdp);\n    peerRef.current.setRemoteDescription(desc).catch(e => console.log(e));\n  }\n\n  function handleICECandidateEvent(e) {\n    if (e.candidate) {\n      const payload = {\n        target: otherUser.current,\n        candidate: e.candidate\n      };\n      socketRef.current.emit(\"ice-candidate\", payload);\n    }\n  }\n\n  function handleNewICECandidateMsg(incoming) {\n    const candidate = new RTCIceCandidate(incoming);\n    peerRef.current.addIceCandidate(candidate).catch(e => console.log(e));\n  }\n\n  function handleTrackEvent(e) {\n    partnerVideo.current.srcObject = e.streams[0];\n  }\n\n  ;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"social-box\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 22\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-lg-4 col-xs-12 text-center\",\n    id: \"column1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"view\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"fa fa-behance fa-3x\",\n    \"aria-hidden\": \"true\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 37\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"box-title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 37\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 41\n    }\n  }, \"Display Name\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"box-text\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 37\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 37\n    }\n  }, \" \", /*#__PURE__*/React.createElement(\"video\", {\n    className: \"partner\",\n    width: \"300px\",\n    autoPlay: true,\n    ref: partnerVideo,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 44\n    }\n  })), /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 37\n    }\n  }, \"  \", /*#__PURE__*/React.createElement(\"video\", {\n    width: \"300px\",\n    autoPlay: true,\n    ref: userVideo,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 45\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"box-btn\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 37\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-lg-4 col-xs-12  text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 30\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"box\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"fa fa-twitter fa-3x\",\n    \"aria-hidden\": \"true\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 37\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"box-title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 37\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 41\n    }\n  }, \"Twitter\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"box-text\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 37\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 41\n    }\n  }, \"Lorem ipsum dolor sit amet, id quo eruditi eloquentiam. Assum decore te sed. Elitr scripta ocurreret qui ad.\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"box-btn\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 37\n    }\n  })))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-lg-4 col-xs-12 text-center\",\n    style: {\n      bacgroundColor: 'black'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"holder\",\n    style: {\n      bacgroundColor: 'black'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"fa fa-pinterest-p fa-3x\",\n    \"aria-hidden\": \"true\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 37\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"box-title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 37\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 41\n    }\n  }, \"Pinterest\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"box-text\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 37\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 41\n    }\n  }, \"Lorem ipsum dolor sit amet, id quo eruditi eloquentiam. Assum decore te sed. Elitr scripta ocurreret qui ad.\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"box-btn\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 37\n    }\n  })))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-lg-4 col-xs-12 text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 30\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"box\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"fa fa-facebook fa-3x\",\n    \"aria-hidden\": \"true\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 37\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"box-title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 37\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 41\n    }\n  }, \"Facebook\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"box-text\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 37\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 41\n    }\n  }, \"Lorem ipsum dolor sit amet, id quo eruditi eloquentiam. Assum decore te sed. Elitr scripta ocurreret qui ad.\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"box-btn\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 37\n    }\n  }))), \"  \", /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 37\n    }\n  }), \" \", /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 43\n    }\n  }), \" \", /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 49\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 54\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-lg-4 col-xs-12 text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 30\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"box\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"fa fa-github fa-3x\",\n    \"aria-hidden\": \"true\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 37\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"box-title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 37\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 41\n    }\n  }, \"Github\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"box-text\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 37\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 41\n    }\n  }, \"Lorem ipsum dolor sit amet, id quo eruditi eloquentiam. Assum decore te sed. Elitr scripta ocurreret qui ad.\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"box-btn\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 37\n    }\n  })))));\n};\n\nexport default Room;","map":{"version":3,"sources":["/Users/batson24/Desktop/Date_Site/frontend/src/Routes/Room.js"],"names":["React","useRef","useEffect","callUser","io","Room","props","userVideo","partnerVideo","peerRef","socketRef","otherUser","userStream","navigator","mediaDevices","getUserMedia","audio","video","then","stream","current","srcObject","connect","emit","match","params","roomID","on","userID","handleRecieveCall","handleAnswer","handleNewICECandidateMsg","createPeer","getTracks","forEach","track","addTrack","peer","RTCPeerConnection","iceServers","urls","credential","username","onicecandidate","handleICECandidateEvent","ontrack","handleTrackEvent","onnegotiationneeded","handleNegotiationNeededEvent","createOffer","offer","setLocalDescription","payload","target","caller","id","sdp","localDescription","catch","e","console","log","incoming","desc","RTCSessionDescription","setRemoteDescription","createAnswer","answer","message","candidate","RTCIceCandidate","addIceCandidate","streams","bacgroundColor"],"mappings":"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","sourcesContent":["import React, { useRef, useEffect,callUser } from \"react\";\nimport io from \"socket.io-client\";\n\nconst Room = (props) => {\n    const userVideo = useRef();\n    const partnerVideo = useRef();\n    const peerRef = useRef();\n    const socketRef = useRef();\n    const otherUser = useRef();\n    const userStream = useRef();\n\n    useEffect(() => {\n        navigator.mediaDevices.getUserMedia({ audio: true, video: true }).then(stream => {\n            userVideo.current.srcObject = stream;\n            userStream.current = stream;\n\n            socketRef.current = io.connect(\"/\");\n            socketRef.current.emit(\"join room\", props.match.params.roomID);\n\n            socketRef.current.on('other user', userID => {\n                callUser(userID);\n                otherUser.current = userID;\n            });\n\n            socketRef.current.on(\"user joined\", userID => {\n                otherUser.current = userID;\n            });\n\n            socketRef.current.on(\"offer\", handleRecieveCall);\n\n            socketRef.current.on(\"answer\", handleAnswer);\n\n            socketRef.current.on(\"ice-candidate\", handleNewICECandidateMsg);\n        });\n\n    }, []);\n\n    function callUser(userID) {\n        peerRef.current = createPeer(userID);\n        userStream.current.getTracks().forEach(track => peerRef.current.addTrack(track, userStream.current));\n    }\n\n    function createPeer(userID) {\n        const peer = new RTCPeerConnection({\n            iceServers: [\n                {\n                    urls: \"stun:stun.stunprotocol.org\"\n                },\n                {\n                    urls: 'turn:numb.viagenie.ca',\n                    credential: 'batson',\n                    username: 'webrtc@live.com'\n                },\n            ]\n        });\n\n        peer.onicecandidate = handleICECandidateEvent;\n        peer.ontrack = handleTrackEvent;\n        peer.onnegotiationneeded = () => handleNegotiationNeededEvent(userID);\n\n        return peer;\n    }\n\n    function handleNegotiationNeededEvent(userID) {\n        peerRef.current.createOffer().then(offer => {\n            return peerRef.current.setLocalDescription(offer);\n        }).then(() => {\n            const payload = {\n                target: userID,\n                caller: socketRef.current.id,\n                sdp: peerRef.current.localDescription\n            };\n            socketRef.current.emit(\"offer\", payload);\n        }).catch(e => console.log(e));\n    }\n\n    function handleRecieveCall(incoming) {\n        peerRef.current = createPeer();\n        const desc = new RTCSessionDescription(incoming.sdp);\n        peerRef.current.setRemoteDescription(desc).then(() => {\n            userStream.current.getTracks().forEach(track => peerRef.current.addTrack(track, userStream.current));\n        }).then(() => {\n            return peerRef.current.createAnswer();\n        }).then(answer => {\n            return peerRef.current.setLocalDescription(answer);\n        }).then(() => {\n            const payload = {\n                target: incoming.caller,\n                caller: socketRef.current.id,\n                sdp: peerRef.current.localDescription\n            }\n            socketRef.current.emit(\"answer\", payload);\n        })\n    }\n\n    function handleAnswer(message) {\n        const desc = new RTCSessionDescription(message.sdp);\n        peerRef.current.setRemoteDescription(desc).catch(e => console.log(e));\n    }\n\n    function handleICECandidateEvent(e) {\n        if (e.candidate) {\n            const payload = {\n                target: otherUser.current,\n                candidate: e.candidate,\n            }\n            socketRef.current.emit(\"ice-candidate\", payload);\n        }\n    }\n\n    function handleNewICECandidateMsg(incoming) {\n        const candidate = new RTCIceCandidate(incoming);\n\n        peerRef.current.addIceCandidate(candidate)\n            .catch(e => console.log(e));\n    }\n\n    function handleTrackEvent(e) {\n        partnerVideo.current.srcObject = e.streams[0];\n    };\n\n    return (\n\n        <div className=\"social-box\">\n                    \n                \n                     <div className=\"row1\">\n                         \n                            <div className=\"col-lg-4 col-xs-12 text-center\" id='column1'>\n                                <div className='view'>\n                                    <i className=\"fa fa-behance fa-3x\" aria-hidden=\"true\"></i>\n                                    <div className=\"box-title\">\n                                        <h3>Display Name</h3>\n                                    </div>\n                                   \n                                    <div className=\"box-text\">\n                                    <span> <video className='partner' width='300px' autoPlay ref={partnerVideo} /></span> \n                                    <span>  <video width='300px' autoPlay ref={userVideo} />\n                                     \n                             </span>\n                                    </div>\n                                    <div className=\"box-btn\">\n                                       \n                                    </div>\n                                 </div>\n                            </div>\t \n                            \n                             <div className=\"col-lg-4 col-xs-12  text-center\">\n                                <div className=\"box\">\n                                    <i className=\"fa fa-twitter fa-3x\" aria-hidden=\"true\"></i>\n                                    <div className=\"box-title\">\n                                        <h3>Twitter</h3>\n                                    </div>\n                                    <div className=\"box-text\">\n                                        <span>Lorem ipsum dolor sit amet, id quo eruditi eloquentiam. Assum decore te sed. Elitr scripta ocurreret qui ad.</span>\n                                    </div>\n                                    <div className=\"box-btn\">\n                                       \n                                    </div>\n                                 </div>\n                            </div>\t \n                            </div>\n\n                            <div className=\"row2\">\n                            <div className=\"col-lg-4 col-xs-12 text-center\" style={{bacgroundColor:'black'}}>\n                                <div className=\"holder\" style={{bacgroundColor:'black'}} >\n                                    <i className=\"fa fa-pinterest-p fa-3x\" aria-hidden=\"true\"></i>\n                                    <div className=\"box-title\">\n                                        <h3>Pinterest</h3>\n                                    </div>\n                                    <div className=\"box-text\">\n                                        <span>Lorem ipsum dolor sit amet, id quo eruditi eloquentiam. Assum decore te sed. Elitr scripta ocurreret qui ad.</span>\n                                    </div>\n                                    <div className=\"box-btn\">\n                                       \n                                    </div>\n                                 </div>\n                            </div>\t \n                            </div>\n                      \n                            <div className=\"row3\">\n                            \n                             <div className=\"col-lg-4 col-xs-12 text-center\">\n                                <div className=\"box\">\n                                    <i className=\"fa fa-facebook fa-3x\" aria-hidden=\"true\"></i>\n                                    <div className=\"box-title\">\n                                        <h3>Facebook</h3>\n                                    </div>\n                                    <div className=\"box-text\">\n                                        <span>Lorem ipsum dolor sit amet, id quo eruditi eloquentiam. Assum decore te sed. Elitr scripta ocurreret qui ad.</span>\n                                    </div>\n                                    <div className=\"box-btn\">\n                                       \n                                    </div>\n                                 </div>\n                            </div>\t <br/> <br/> <br/><br/>\n                           \n                            \n                             \n                            \n                             <div className=\"col-lg-4 col-xs-12 text-center\">\n                                <div className=\"box\">\n                                    <i className=\"fa fa-github fa-3x\" aria-hidden=\"true\"></i>\n                                    <div className=\"box-title\">\n                                        <h3>Github</h3>\n                                    </div>\n                                    <div className=\"box-text\">\n                                        <span>Lorem ipsum dolor sit amet, id quo eruditi eloquentiam. Assum decore te sed. Elitr scripta ocurreret qui ad.</span>\n                                    </div>\n                                    <div className=\"box-btn\">\n                                       \n                                    </div>\n                                 </div>\n                            </div>\n                    \n                    </div>\t\t\n               \n            </div>\n   \n            \n        )\n};\n\nexport default Room;"]},"metadata":{},"sourceType":"module"}